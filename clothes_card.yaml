button_card_templates:
  clothes_card:
    show_name: false
    show_label: true
    variables:
      # üëá HIT SKA DU TITTA üëá
      # H√§r anger du dina egna sensorer.
      weather_entity: weather.home
      temp_entity: sensor.outdoor_temperature
      uv_entity: sensor.uv_index
      wind_entity: sensor.wind_speed
      season_entity: sensor.season
      rain_entity: sensor.rain_today  # total mm nederb√∂rd idag (eller senaste 24h)

    label: |
      [[[
        const weather = states[variables.weather_entity]?.state || "unknown";
        const temp = parseFloat(states[variables.temp_entity]?.state) || 0;
        const uv = parseFloat(states[variables.uv_entity]?.state) || 0;
        const wind = parseFloat(states[variables.wind_entity]?.state) || 0;
        const season = states[variables.season_entity]?.state || "ok√§nd";
        const rain = parseFloat(states[variables.rain_entity]?.state) || 0;

        // --- Upplevd temperatur ---
        let upplevdTemp = temp;
        if (wind >= 8) upplevdTemp -= 2;
        if (wind >= 12) upplevdTemp -= 2;

        let clothes = [];

        function capFirst(str) {
          return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // --- JACKA ---
        if (weather.includes("snow") || upplevdTemp < -1) {
          clothes.push("Vinterjacka");
        } else if (upplevdTemp <= 10) {
          clothes.push("Skaljacka","Fleece");
        } else {
          clothes.push("Skaljacka");
        }

        // --- BYXOR ---
        if (weather.includes("snow")) {
          clothes.push("Termobyxor");
        } else if (weather.includes("rain") || rain >= 3) {
          clothes.push("Regnbyxor");
        } else if (upplevdTemp <= 10) {
          clothes.push("Skalbyxor");
        }

        // --- SKOR ---
        if (weather.includes("snow") || upplevdTemp < -1) {
          clothes.push("K√§ngor");
        } else if (weather.includes("rain") || rain >= 3) {
          clothes.push("St√∂vlar");
        } else if (upplevdTemp <= 10) {
          clothes.push("Funktionsskor");
        } else {
          clothes.push("Sneakers");
        }

        // --- M√ñSSA ---
        if (upplevdTemp < -1) {
          clothes.push("Vinterm√∂ssa");
        } else if (upplevdTemp <= 4 || wind > 8) {
          clothes.push("Tunn m√∂ssa");
        }

        // --- VANTAR ---
        if (upplevdTemp < -1) {
          clothes.push("Vintervantar");
        } else if (upplevdTemp <= 4 || wind > 8) {
          clothes.push("Tunna vantar");
        }

        // --- HALSDUK ---
        if (upplevdTemp < -1 || (upplevdTemp <= 5 && wind > 6)) {
          clothes.push("Halsduk");
        }

        // --- UV / SOL ---
        if ((season == "sommar" || season == "var") && uv > 2) {
          clothes.push("Keps","Solglas");
        }
        if ((season == "host" || season == "vinter") && uv > 4) {
          clothes.push("Solglas");
        }

        return clothes.map(c => capFirst(c)).join(", ");
      ]]]
    custom_fields:
      title: "Rekommenderad kl√§dsel:"
      icons: |
        [[[
          const weather = states[variables.weather_entity]?.state || "unknown";
          const temp = parseFloat(states[variables.temp_entity]?.state) || 0;
          const uv = parseFloat(states[variables.uv_entity]?.state) || 0;
          const wind = parseFloat(states[variables.wind_entity]?.state) || 0;
          const season = states[variables.season_entity]?.state || "ok√§nd";
          const rain = parseFloat(states[variables.rain_entity]?.state) || 0;

          // --- Upplevd temperatur ---
          let upplevdTemp = temp;
          if (wind >= 8) upplevdTemp -= 2;
          if (wind >= 12) upplevdTemp -= 2;

          let clothes = [];

          // --- JACKA ---
          if (weather.includes("snow") || upplevdTemp < -1) {
            clothes.push("vinterjacka");
          } else if (upplevdTemp <= 10) {
            clothes.push("skaljacka","fleece");
          } else {
            clothes.push("skaljacka");
          }

          // --- BYXOR ---
          if (weather.includes("snow")) {
            clothes.push("termobyxor");
          } else if (weather.includes("rain") || rain >= 3) {
            clothes.push("regnbyxor");
          } else if (upplevdTemp <= 10) {
            clothes.push("skalbyxor");
          }

          // --- SKOR ---
          if (weather.includes("snow") || upplevdTemp < -1) {
            clothes.push("kangor");
          } else if (weather.includes("rain") || rain >= 3) {
            clothes.push("stovlar");
          } else if (upplevdTemp <= 10) {
            clothes.push("hostsko");
          } else {
            clothes.push("sneakers");
          }

          // --- M√ñSSA ---
          if (upplevdTemp < -1) {
            clothes.push("vintermossa");
          } else if (upplevdTemp <= 4 || wind > 8) {
            clothes.push("mossa");
          }

          // --- VANTAR ---
          if (upplevdTemp < -1) {
            clothes.push("vintervantar");
          } else if (upplevdTemp <= 4 || wind > 8) {
            clothes.push("vantar");
          }

          // --- HALSDUK ---
          if (upplevdTemp < -1 || (upplevdTemp <= 5 && wind > 6)) {
            clothes.push("halsduk");
          }

          // --- UV / SOL ---
          if ((season == "sommar" || season == "var") && uv > 2) {
            clothes.push("keps","solglas");
          }
          if ((season == "host" || season == "vinter") && uv > 4) {
            clothes.push("solglas");
          }

          const base = "/local/pics/clothes/";
          return `<div style="display:flex;flex-wrap:wrap;justify-content:center;gap:6px;">
            ${clothes.map(c => `<img src='${base}${c}.png' style="height:65px;width:auto;filter: drop-shadow(0 0 3px white);">`).join("")}
          </div>`;
        ]]]
      note: Men kika g√§rna prognosen f√∂r resten av dagen ocks√•
    styles:
      grid:
        - grid-template-areas: '"title" "icons" "l" "note"'
        - grid-template-rows: auto auto auto auto
        - grid-template-columns: 1fr
      custom_fields:
        title:
          - justify-self: center
          - font-size: 16px
          - font-weight: bold
          - margin-top: 4px
          - margin-bottom: 2px
        icons:
          - justify-self: center
          - margin-bottom: 2px
        note:
          - font-size: 11px
          - color: gray
          - text-align: center
          - margin-bottom: 4px
      card:
        - height: 150px
        - padding: 4px
        - display: flex
        - flex-direction: column
        - justify-content: space-between
      label:
        - font-size: 13px
        - text-align: center
        - white-space: normal
        - margin-bottom: 2px
